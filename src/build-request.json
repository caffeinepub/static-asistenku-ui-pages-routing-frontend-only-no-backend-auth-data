{
  "kind": "build_request",
  "title": "Fix superadmin claim by bootstrapping first admin without AccessControl.assignRole",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-113",
      "text": "Patch `backend/main.mo` in `public shared ({ caller }) func claimSuperadmin() : async ()` to remove the admin-gated call to `AccessControl.assignRole(...)` and instead bootstrap the first admin by directly writing to `accessControlState`.\n\nSpecifically, replace ONLY the single line:\n- `AccessControl.assignRole(accessControlState, caller, caller, #admin);`\n\nwith EXACTLY these two lines (and nothing else):\n- `accessControlState.userRoles.add(caller, #admin);`\n- `accessControlState.adminAssigned := true;`\n\nAll other logic and ordering inside `claimSuperadmin()` must remain unchanged.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Pastikan hanya mengganti 1 baris AccessControl.assignRole(...) menjadi 2 baris bootstrap state di atas."
        ]
      },
      "acceptanceCriteria": [
        "In `backend/main.mo`, inside `claimSuperadmin()`, the only functional change is replacing `AccessControl.assignRole(accessControlState, caller, caller, #admin);` with:\n  - `accessControlState.userRoles.add(caller, #admin);`\n  - `accessControlState.adminAssigned := true;`",
        "No other lines in `claimSuperadmin()` are modified (no refactors, no reordered checks, no changed trap messages, no added gates).",
        "No other files are modified."
      ]
    },
    {
      "id": "REQ-114",
      "text": "Ensure the backend compiles and the superadmin claim no longer fails with the error text \"Only admins can assign user roles\" when the first caller claims superadmin.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Setelah build, tombol Claim Superadmin harus tidak lagi menghasilkan error: “Only admins can assign user roles”."
        ]
      },
      "acceptanceCriteria": [
        "Project builds successfully after the patch (no Motoko compile errors).",
        "Calling `claimSuperadmin()` as the first eligible authenticated user succeeds without throwing an \"Only admins can assign user roles\"-type error."
      ]
    }
  ],
  "constraints": [
    "Use English for any user-facing text in this build request.",
    "Modify only `backend/main.mo`.",
    "Within `claimSuperadmin()`, change only the single `AccessControl.assignRole(...)` line into the two specified bootstrap lines; do not change any other logic in the function.",
    "Do not modify any other backend functions, types, storage variables, imports, or authorization modules.",
    "Do not modify any frontend files.",
    "Do not add or modify `backend/migration.mo`."
  ],
  "nonGoals": [
    "Do not redesign the overall role/registration model.",
    "Do not change any other authorization behavior beyond the specified bootstrap change.",
    "Do not implement new UI/UX changes or adjust InternalLogin behavior in this patch."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  },
  "userProfileUpdate": {
    "goalsToAdd": [],
    "goalsToRemove": [],
    "preferencesToAdd": [],
    "preferencesToRemove": [],
    "miscToAdd": [],
    "miscToRemove": [],
    "fieldsToSet": {},
    "fieldsToDelete": []
  }
}